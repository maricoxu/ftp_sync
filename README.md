# ProFTPD æœåŠ¡å™¨ï¼šç”¨äº VS Code SFTP åŒæ­¥

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªé¢„é…ç½®çš„ ProFTPD æœåŠ¡å™¨è®¾ç½®ï¼Œæ—¨åœ¨ Docker å®¹å™¨å†…éƒ¨è¿è¡Œã€‚å®ƒé€šè¿‡ FTP åè®®ï¼Œç®€åŒ–äº†æœ¬åœ° VS Code å·¥ä½œåŒºä¸è¿œç¨‹å¼€å‘æœºå™¨ä¹‹é—´çš„æ–‡ä»¶åŒæ­¥ã€‚

ğŸ† **é¡¹ç›®ä¼˜åŒ–äº®ç‚¹**:
- ğŸ‡¨ğŸ‡³ **ä¸­æ–‡å‹å¥½**: é»˜è®¤ä¸­æ–‡æ–‡æ¡£ï¼Œä¸­æ–‡ç•Œé¢æç¤º
- ğŸ¨ **è§†è§‰å¢å¼º**: å½©è‰²é«˜äº®æç¤ºï¼Œæ“ä½œçŠ¶æ€ä¸€ç›®äº†ç„¶
- ğŸ“ **é€šç”¨æ€§ä¼˜åŒ–**: æ— ç¡¬ç¼–ç è·¯å¾„ï¼Œæ”¯æŒä»»æ„éƒ¨ç½²ä½ç½®
- ğŸ”€ **å¤šæœåŠ¡å™¨æ”¯æŒ**: è¯¦ç»†çš„å¤š SFTP é…ç½®è¯´æ˜

æœåŠ¡å™¨é…ç½®ä¸ºä½¿ç”¨ä¸€ä¸ªä¸“ç”¨çš„ FTP ç”¨æˆ· (`ftpuser`)ï¼Œå…¶ä¸»ç›®å½•åœ¨è¿œç¨‹æœºå™¨ä¸Šè®¾ç½®ä¸º `/home/Code`ã€‚è¿™ä¸ª `/home/Code` ç›®å½•ä¹Ÿåº”ä½œä¸ºä½ çš„ VS Code SFTP æ’ä»¶ä¸­ `remotePath` çš„ç›®æ ‡ã€‚

## ä¸»è¦ç‰¹æ€§

*   **ä¸“ç”¨ FTP ç”¨æˆ·**: ä½¿ç”¨é root ç”¨æˆ· (`ftpuser`) è¿›è¡Œ FTP è®¿é—®ã€‚
*   **ç›®æ ‡åŒæ­¥ç›®å½•**: é…ç½®ä¸ºåŒæ­¥åˆ° `/home/Code`ã€‚
*   **è‡ªåŠ¨åŒ–å®‰è£…**: `init.sh` è„šæœ¬è´Ÿè´£åˆ›å»ºç”¨æˆ·ã€è®¾ç½®å¯†ç ã€é…ç½®ç›®å½•æƒé™ä»¥åŠç”Ÿæˆ `proftpd.conf` æ–‡ä»¶ã€‚
*   **ä¾¿æ·æœåŠ¡ç®¡ç†**: `start.sh` å’Œ `stop.sh` è„šæœ¬ç”¨äºæ§åˆ¶ ProFTPD æœåŠ¡ã€‚
*   **Docker å‹å¥½**: è®¾è®¡ä¸ºå¯ä»¥è½»æ¾æ‰“åŒ…å¹¶åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œã€‚

## å…ˆå†³æ¡ä»¶

*   **Docker**: å¿…é¡»å®‰è£…åœ¨å°†è¿è¡Œ ProFTPD æœåŠ¡å™¨çš„è¿œç¨‹å¼€å‘æœºå™¨ä¸Šã€‚
*   **VS Code**: å¹¶å®‰è£… SFTP æ’ä»¶ (ä¾‹å¦‚ liximomo å¼€å‘çš„ "SFTP" æ’ä»¶)ã€‚
*   **åŸºç¡€ Linux/Shell çŸ¥è¯†**: ç”¨äºåœ¨è¿œç¨‹æœºå™¨ä¸Šéƒ¨ç½²å’Œè¿è¡Œè„šæœ¬ã€‚

## ç›®å½•ç»“æ„

```
proftpd/
â”œâ”€â”€ bin/          # ProFTPD äºŒè¿›åˆ¶æ–‡ä»¶ (é€šå¸¸æ˜¯ ProFTPD å®‰è£…åŒ…çš„ä¸€éƒ¨åˆ†)
â”œâ”€â”€ sbin/         # ProFTPD å®ˆæŠ¤è¿›ç¨‹ (proftpd)
â”œâ”€â”€ etc/
â”‚   â””â”€â”€ proftpd.conf  # ä¸»é…ç½®æ–‡ä»¶ (ç”± init.sh ç”Ÿæˆ)
â”œâ”€â”€ include/      # ProFTPD åŒ…å«æ–‡ä»¶
â”œâ”€â”€ lib/          # ProFTPD åº“æ–‡ä»¶
â”œâ”€â”€ libexec/      # ProFTPD è¾…åŠ©ç¨‹åº
â”œâ”€â”€ share/        # ProFTPD å…±äº«æ•°æ®
â”œâ”€â”€ var/          # è¿è¡Œæ—¶æ•°æ® (æ—¥å¿—, PID æ–‡ä»¶)
â”‚   â”œâ”€â”€ proftpd.pid
â”‚   â”œâ”€â”€ proftpd.system.log
â”‚   â””â”€â”€ proftpd.transfer.log
â”œâ”€â”€ init.sh       # åˆå§‹åŒ–è„šæœ¬ (åˆ›å»ºç”¨æˆ·, è®¾ç½®å¯†ç , é…ç½®)
â”œâ”€â”€ start.sh      # å¯åŠ¨ ProFTPD æœåŠ¡å™¨çš„è„šæœ¬
â”œâ”€â”€ stop.sh       # åœæ­¢ ProFTPD æœåŠ¡å™¨çš„è„šæœ¬
â””â”€â”€ README.md     # æœ¬ä¸­æ–‡ç‰ˆè¯´æ˜æ–‡æ¡£ (é»˜è®¤)
â””â”€â”€ README_en.md  # è‹±æ–‡ç‰ˆè¯´æ˜æ–‡æ¡£
```
*(æ³¨æ„: `bin/`, `sbin/`, `include/`, `lib/`, `libexec/`, `share/` ç›®å½•é€šå¸¸æ˜¯æ ‡å‡† ProFTPD å®‰è£…çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœä½ ä»ä¸€ä¸ªæœ€å°åŒ–çš„åŒ…æ„å»ºï¼Œè¯·ç¡®ä¿è¿™äº›ç›®å½•è¢«æ­£ç¡®å¡«å……ï¼Œæˆ–è€… ProFTPD åœ¨ Docker å®¹å™¨ä¸­å·²å…¨å±€å®‰è£…ï¼Œå¹¶ä¸”è¿™äº›è„šæœ¬èƒ½å¤Ÿæ‰¾åˆ°å®ƒã€‚)*

## å®‰è£…ä¸é…ç½®

**åœ¨è¿œç¨‹å¼€å‘æœºå™¨ä¸Š (Docker å†…éƒ¨æˆ–ç›´æ¥éƒ¨ç½²):**

1.  **éƒ¨ç½²æ–‡ä»¶**:
    *   å°†æ•´ä¸ªé¡¹ç›®ç›®å½• (åŒ…å« `init.sh`, `start.sh`, `stop.sh` ä»¥åŠ ProFTPD çš„å®‰è£…å­ç›®å½•) ä¼ è¾“åˆ°ä½ çš„è¿œç¨‹æœºå™¨ã€‚å¯ä»¥é€‰æ‹©ä»»æ„åˆé€‚çš„ä½ç½®ï¼Œæ¯”å¦‚ `/home/Code/ftp_sync`ã€`/opt/ftp_sync` ç­‰ã€‚

2.  **è¿›å…¥é¡¹ç›®ç›®å½•**:
    ```bash
    cd [ä½ çš„é¡¹ç›®ç›®å½•è·¯å¾„]
    ```
    *(è¯·å°† `[ä½ çš„é¡¹ç›®ç›®å½•è·¯å¾„]` æ›¿æ¢ä¸ºå®é™…çš„éƒ¨ç½²è·¯å¾„)*

3.  **è¿è¡Œåˆå§‹åŒ–è„šæœ¬**:
    
    ğŸ¯ **æ–°ç‰¹æ€§**: ç°åœ¨æ”¯æŒè‡ªå®šä¹‰ FTP å·¥ä½œç›®å½•ï¼
    
    **äº¤äº’å¼é…ç½®**ï¼ˆæ¨èï¼‰ï¼š
    ```bash
    bash ./init.sh
    # è„šæœ¬ä¼šæç¤ºä½ è¾“å…¥æˆ–é€‰æ‹© FTP å·¥ä½œç›®å½•
    # é»˜è®¤ä¸º /home/Codeï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–è·¯å¾„
    ```
    
    **å‘½ä»¤è¡Œå‚æ•°æ¨¡å¼**ï¼š
    ```bash
    # ä½¿ç”¨é»˜è®¤è·¯å¾„
    bash ./init.sh /home/Code
    
    # æˆ–æŒ‡å®šè‡ªå®šä¹‰è·¯å¾„
    bash ./init.sh /var/www/myproject
    ```
    
    *   æ­¤è„šæœ¬å°†æ‰§è¡Œä»¥ä¸‹æ“ä½œ:
        *   æç¤ºé€‰æ‹©æˆ–è¾“å…¥ FTP å·¥ä½œç›®å½•è·¯å¾„
        *   åˆ›å»º `ftpuser` ç”¨æˆ· (å¦‚æœä¸å­˜åœ¨)ï¼Œå…¶ä¸»ç›®å½•ä¸ºæŒ‡å®šè·¯å¾„
        *   è®¾ç½® `ftpuser` çš„å¯†ç ä¸º `ftp123`
        *   ä¸ºæŒ‡å®šç›®å½•ä»¥åŠ ProFTPD å®‰è£…ç›®å½•è®¾ç½®åˆé€‚çš„æ‰€æœ‰æƒå’Œæƒé™
        *   ç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„ `etc/proftpd.conf` é…ç½®æ–‡ä»¶ï¼Œé€‚åº”æ‰€é€‰è·¯å¾„
        *   æ˜¾ç¤ºå®Œæ•´çš„ VS Code SFTP é…ç½®ç¤ºä¾‹
    
    *   è¯·ä»”ç»†æ£€æŸ¥ `init.sh` çš„è¾“å‡ºï¼Œç¡®ä¿æ²¡æœ‰é”™è¯¯ã€‚

4.  **å¯åŠ¨ ProFTPD æœåŠ¡å™¨**:
    ```bash
    bash ./start.sh
    ```
    *   è¿™å°†åœ¨åå°å¯åŠ¨ ProFTPD å®ˆæŠ¤è¿›ç¨‹ã€‚
    *   æ£€æŸ¥é”™è¯¯: `cat var/proftpd.system.log`
    *   éªŒè¯æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œ: `ps aux | grep proftpd`

**åœ¨ä½ çš„æœ¬åœ°æœºå™¨ä¸Š (VS Code):**

1.  **å®‰è£… SFTP æ’ä»¶**: å¦‚æœå°šæœªå®‰è£…ï¼Œè¯·ä» VS Code Marketplace å®‰è£…ä¸€ä¸ª SFTP æ’ä»¶ï¼Œä¾‹å¦‚ liximomo å¼€å‘çš„ "SFTP"ã€‚

2.  **é…ç½® `sftp.json`**:
    *   åœ¨ä½ çš„æœ¬åœ° VS Code é¡¹ç›®ä¸­ï¼Œåˆ›å»ºæˆ–ä¿®æ”¹ `.vscode/sftp.json` æ–‡ä»¶:
    ```json
    {
        "name": "æˆ‘çš„è¿œç¨‹å¼€å‘æœåŠ¡å™¨",
        "host": "your_remote_machine_ip_or_hostname", // æ›¿æ¢ä¸ºä½ çš„è¿œç¨‹æœºå™¨IPæˆ–ä¸»æœºå
        "protocol": "ftp", // é‡è¦: ä½¿ç”¨ 'ftp', è€Œé 'sftp'
        "port": 8021,     // å¿…é¡»ä¸ proftpd.conf ä¸­çš„ Port ä¸€è‡´
        "username": "ftpuser",
        "password": "ftp123",
        "remotePath": "/home/Code", // æœåŠ¡å™¨ä¸Šçš„ç›®æ ‡ç›®å½•
        "uploadOnSave": true,
        "useTempFile": false,
        "openSsh": false,
        "passive": true, // å¯¹äºé€šè¿‡é˜²ç«å¢™/NATçš„FTPè¿æ¥é€šå¸¸æœ‰å¸®åŠ©
        "watcher": {
            "files": "**/*", // æ ¹æ®éœ€è¦è°ƒæ•´ glob æ¨¡å¼
            "autoUpload": true,
            "autoDelete": true
        },
        "ignore": [
            ".vscode",
            ".git",
            ".DS_Store",
            "**/node_modules/**"
        ]
    }
    ```
    *   **å…³é”®è®¾ç½®**:
        *   `host`: ä½ çš„è¿œç¨‹æœºå™¨çš„ IP åœ°å€æˆ–ä¸»æœºå (å¦‚æœæ˜¯é€šè¿‡ç«¯å£è½¬å‘çš„ Docker ä¸»æœºï¼Œåˆ™å¡«å†™ Docker ä¸»æœºçš„ IP)ã€‚
        *   `protocol`: å¿…é¡»æ˜¯ `"ftp"`ã€‚
        *   `port`: å¿…é¡»æ˜¯ `8021` (ç”± `init.sh` åœ¨ `proftpd.conf` ä¸­å®šä¹‰)ã€‚
        *   `username`: `"ftpuser"`ã€‚
        *   `password`: `"ftp123"`ã€‚
        *   `remotePath`: `"/home/Code"`ã€‚
        *   `passive`: é€šå¸¸å»ºè®®è®¾ç½®ä¸º `true`ã€‚

3.  **è¿æ¥ä¸åŒæ­¥**:
    *   ä½¿ç”¨ä½ çš„ SFTP æ’ä»¶çš„å‘½ä»¤ (é€šå¸¸åœ¨ VS Code å‘½ä»¤é¢æ¿ä¸­è¾“å…¥ "SFTP" æ‰¾åˆ°) æ¥è¿æ¥ã€ä¸Šä¼ ã€ä¸‹è½½æˆ–åŒæ­¥ä½ çš„é¡¹ç›®ã€‚

## å¤šæœåŠ¡å™¨ SFTP é…ç½®

### æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ Profiles é…ç½®ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€çµæ´»ä¸”é«˜æ•ˆçš„å¤šæœåŠ¡å™¨é…ç½®æ–¹å¼ï¼š

```json
{
    "name": "é»˜è®¤æœåŠ¡å™¨",
    "protocol": "ftp",
    "port": 8021,
    "username": "ftpuser",
    "password": "ftp123",
    "remotePath": "/home/Code",
    "uploadOnSave": true,
    "passive": true,
    "profiles": {
        "dev": {
            "name": "å¼€å‘ç¯å¢ƒ",
            "host": "dev-server.example.com",
            "remotePath": "/home/Code/dev",
            "uploadOnSave": true
        },
        "test": {
            "name": "æµ‹è¯•ç¯å¢ƒ",
            "host": "test-server.example.com",
            "remotePath": "/home/Code/test",
            "uploadOnSave": false
        },
        "prod": {
            "name": "ç”Ÿäº§ç¯å¢ƒ",
            "host": "prod-server.example.com",
            "remotePath": "/home/Code/prod",
            "uploadOnSave": false
        }
    },
    "defaultProfile": "dev",
    "ignore": [
        ".vscode",
        ".git",
        ".DS_Store",
        "node_modules/**",
        "*.log"
    ]
}
```

**åˆ‡æ¢æœåŠ¡å™¨**: ä½¿ç”¨å‘½ä»¤ `SFTP: Set Profile` æ¥å¿«é€Ÿåˆ‡æ¢ä¸åŒçš„æœåŠ¡å™¨ç¯å¢ƒã€‚

### æ–¹æ¡ˆäºŒï¼šå¤šé…ç½®æ•°ç»„

é€‚ç”¨äºå®Œå…¨ä¸åŒçš„é¡¹ç›®æˆ–å·¥ä½œåŒºï¼š

```json
[
    {
        "name": "é¡¹ç›®A - ç”Ÿäº§ç¯å¢ƒ",
        "context": "./project-a",
        "host": "server1.example.com",
        "protocol": "ftp",
        "port": 8021,
        "username": "ftpuser",
        "password": "ftp123",
        "remotePath": "/home/Code/project-a",
        "uploadOnSave": true,
        "passive": true
    },
    {
        "name": "é¡¹ç›®B - å¼€å‘ç¯å¢ƒ",
        "context": "./project-b",
        "host": "server2.example.com",
        "protocol": "ftp",
        "port": 8021,
        "username": "ftpuser",
        "password": "ftp123",
        "remotePath": "/home/Code/project-b",
        "uploadOnSave": true,
        "passive": true
    }
]
```

**é‡è¦è¯´æ˜**:
- `context`: æŒ‡å®šæœ¬åœ°ç›®å½•ï¼Œè®©ä¸åŒçš„é¡¹ç›®æ–‡ä»¶å¤¹ä½¿ç”¨ä¸åŒçš„è¿œç¨‹è¿æ¥
- æ¯ä¸ªé…ç½®çš„ `context` å¿…é¡»ä¸åŒ
- `name` åœ¨æ•°ç»„æ¨¡å¼ä¸‹æ˜¯å¿…éœ€çš„

### æ–¹æ¡ˆä¸‰ï¼šå¤šé…ç½®æ–‡ä»¶ç®¡ç†

ä¸ºä¸åŒç¯å¢ƒåˆ›å»ºç‹¬ç«‹çš„é…ç½®æ–‡ä»¶ï¼š

```bash
.vscode/
â”œâ”€â”€ sftp.json          # é»˜è®¤é…ç½®
â”œâ”€â”€ sftp-dev.json      # å¼€å‘ç¯å¢ƒ
â”œâ”€â”€ sftp-test.json     # æµ‹è¯•ç¯å¢ƒ
â””â”€â”€ sftp-prod.json     # ç”Ÿäº§ç¯å¢ƒ
```

ä½¿ç”¨ `SFTP: Config` å‘½ä»¤æ—¶ï¼Œå¯ä»¥é€‰æ‹©åŠ è½½ä¸åŒçš„é…ç½®æ–‡ä»¶ã€‚

### é«˜çº§é…ç½®é€‰é¡¹

```json
{
    "name": "é«˜çº§é…ç½®ç¤ºä¾‹",
    "host": "your-server.com",
    "protocol": "ftp",
    "port": 8021,
    "username": "ftpuser",
    "password": "ftp123",
    "remotePath": "/home/Code",
    "uploadOnSave": true,
    "downloadOnOpen": false,
    "passive": true,
    "ignore": [
        ".vscode",
        ".git/**",
        "*.log",
        "node_modules/**",
        "dist/**",
        "build/**"
    ],
    "watcher": {
        "files": "src/**/*.{js,ts,css,html}",
        "autoUpload": true,
        "autoDelete": false
    },
    "concurrency": 4,
    "connectTimeout": 30000,
    "keepalive": 30000
}
```

**é…ç½®è¯´æ˜**:
- `downloadOnOpen`: æ‰“å¼€æ–‡ä»¶æ—¶æ˜¯å¦è‡ªåŠ¨ä¸‹è½½
- `watcher`: æ–‡ä»¶ç›‘è§†å™¨ï¼Œå¯ä»¥ç›‘è§†ç‰¹å®šæ–‡ä»¶å˜åŒ–
- `concurrency`: å¹¶å‘ä¼ è¾“æ•°é‡
- `connectTimeout`: è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
- `keepalive`: è¿æ¥ä¿æŒæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰

## ç®¡ç† ProFTPD æœåŠ¡

åœ¨è¿œç¨‹æœºå™¨çš„é¡¹ç›®ç›®å½•ä¸‹:

*   **å¯åŠ¨æœåŠ¡**:
    ```bash
    bash ./start.sh
    ```
*   **åœæ­¢æœåŠ¡**:
    ```bash
    bash ./stop.sh
    ```
*   **æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—**:
    ```bash
    tail -f var/proftpd.system.log
    ```
*   **æŸ¥çœ‹ä¼ è¾“æ—¥å¿—**:
    ```bash
    tail -f var/proftpd.transfer.log
    ```

## æ•…éšœæ’é™¤

*   **ç™»å½•ä¸æ­£ç¡® (530 Login incorrect)**:
    *   ä»”ç»†æ£€æŸ¥ `sftp.json` ä¸­çš„ `username` å’Œ `password` æ˜¯å¦ä¸ `ftpuser` å’Œ `ftp123` åŒ¹é…ã€‚
    *   ç¡®ä¿ `init.sh` å·²æˆåŠŸè¿è¡Œå¹¶è®¾ç½®äº†å¯†ç ã€‚
    *   æŸ¥çœ‹ `var/proftpd.system.log` è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚`proftpd.conf` ä¸­åº”åŒ…å« `RequireValidShell off` ä»¥å…è®¸ shell ä¸º `/sbin/nologin` çš„ç”¨æˆ·ç™»å½•ã€‚
*   **è¿æ¥è¢«æ‹’/è¶…æ—¶ (Connection Refused/Timeout)**:
    *   éªŒè¯ ProFTPD æ˜¯å¦æ­£åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šè¿è¡Œ: `ps aux | grep proftpd`ã€‚
    *   ç¡®ä¿ `sftp.json` ä¸­çš„ `port` (8021) ä¸ `etc/proftpd.conf` ä¸­çš„ `Port` ä¸€è‡´ã€‚
    *   æ£€æŸ¥è¿œç¨‹æœºå™¨æˆ–ä»»ä½•ä¸­é—´ç½‘ç»œè®¾å¤‡ä¸Šçš„é˜²ç«å¢™è§„åˆ™ã€‚å¦‚æœåœ¨ Docker ä¸­è¿è¡Œï¼Œç¡®ä¿ç«¯å£ (ä¾‹å¦‚ 8021 å’Œè¢«åŠ¨æ¨¡å¼ç«¯å£ 8000-8999) å·²æ­£ç¡®åœ°ä»å®¹å™¨æ˜ å°„åˆ°ä¸»æœºã€‚
*   **æƒé™è¢«æ‹’ (æ–‡ä»¶æ“ä½œæ—¶)**:
    *   ç¡®ä¿ `init.sh` å·²æˆåŠŸå®Œæˆã€‚å®ƒä¼šå°† `/home/Code` å’Œ `proftpd` ç›®å½•çš„æ‰€æœ‰æƒé€’å½’åœ°è®¾ç½®ä¸º `ftpuser`ã€‚
    *   éªŒè¯ `ftpuser` ç”¨æˆ·ç¡®å®æ‹¥æœ‰è¿œç¨‹æœåŠ¡å™¨ä¸Š `/home/Code` ç›®å½•å†…ç›®æ ‡æ–‡ä»¶/ç›®å½•çš„æ‰€æœ‰æƒ (`ls -la /home/Code`)ã€‚
*   **è¢«åŠ¨æ¨¡å¼é—®é¢˜ (Passive Mode Issues)**:
    *   å¦‚æœåœ¨è¿æ¥åä¸Šä¼ /ä¸‹è½½æˆ–ç›®å½•åˆ—è¡¨å¡ä½ï¼Œåˆ™å¯èƒ½æ˜¯è¢«åŠ¨æ¨¡å¼é—®é¢˜ã€‚ç¡®ä¿ `proftpd.conf` ä¸­å®šä¹‰äº† `PassivePorts 8000 8999`ï¼Œå¹¶ä¸”æ­¤ç«¯å£èŒƒå›´ä¹Ÿå·²åœ¨é˜²ç«å¢™ä¸Šæ‰“å¼€ï¼Œå¹¶åœ¨ä½¿ç”¨ Docker æ—¶è¿›è¡Œäº†æ˜ å°„ã€‚
*   **"DefaultRoot é—®é¢˜" / æ–‡ä»¶ä¸Šä¼ åˆ°é”™è¯¯ç›®å½•**:
    *   æ­¤è®¾ç½®ç‰¹æ„é¿å…ä¾èµ– ProFTPD çš„ `DefaultRoot` æ¥é™åˆ¶ç”¨æˆ·æ ¹ç›®å½• (chroot)ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¸ç¨³å®šï¼Œå°¤å…¶å¯¹äº `root` ç”¨æˆ·ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œ`ftpuser` ä¼šç™»å½•åˆ°å…¶å®é™…ä¸»ç›®å½• (`/home/Code`)ï¼Œç„¶åç”± SFTP å®¢æˆ·ç«¯çš„ `remotePath: "/home/Code"` æ¥å®šä½åˆ°æ­£ç¡®çš„ç›®å½•ã€‚å¦‚æœä» FTP å®¢æˆ·ç«¯çš„è§’åº¦çœ‹ï¼Œæ–‡ä»¶ä»ç„¶ä¸Šä¼ åˆ° `/`ï¼Œå¹¶ä¸” `pwd` å‘½ä»¤æ˜¾ç¤º `/`ï¼Œä½† `ls` å‘½ä»¤åˆ—å‡ºçš„æ˜¯ `/home/Code` çš„å†…å®¹ï¼Œè¿™æ˜¯æ­¤é…ç½®çš„é¢„æœŸè¡Œä¸ºã€‚å…³é”®åœ¨äºï¼Œä½ çš„ SFTP æ’ä»¶ä½¿ç”¨ `remotePath: "/home/Code"` æ—¶ï¼Œä»åº”èƒ½æ­£ç¡®åŒæ­¥åˆ°è¯¥ç‰©ç†è·¯å¾„ã€‚

## å®‰å…¨æ³¨æ„äº‹é¡¹

*   **å¯†ç **: é»˜è®¤å¯†ç  `ftp123` æ˜¯ä¸å®‰å…¨çš„ã€‚å¯¹äºä»»ä½•ç”Ÿäº§æˆ–æ•æ„Ÿç¯å¢ƒï¼Œè¯·åœ¨ `init.sh` (ä¿®æ”¹ `FTP_PASS` å˜é‡) ä¸­æ›´æ”¹å®ƒï¼Œå¹¶ç›¸åº”æ›´æ–°ä½ çš„ `sftp.json` æ–‡ä»¶ã€‚
*   **é˜²ç«å¢™**: å¦‚æœå¯èƒ½ï¼Œå°†å¯¹ç«¯å£ 8021 å’Œè¢«åŠ¨ç«¯å£èŒƒå›´ (8000-8999) çš„è®¿é—®é™åˆ¶åœ¨å—ä¿¡ä»»çš„ IP åœ°å€ã€‚
*   **TLS/SSL**: æ­¤é…ç½®ä¸åŒ…å«é€šè¿‡ TLS/SSL (FTPS) çš„ FTP æ¥åŠ å¯†è¿æ¥ã€‚ä¸ºå¢å¼ºå®‰å…¨æ€§ï¼Œè¯·è€ƒè™‘é…ç½® ProFTPD ä½¿ç”¨ TLSã€‚
*   **æƒé™**: `init.sh` è„šæœ¬æˆäºˆ `ftpuser` å¯¹ `/home/Code` çš„å¹¿æ³›æ§åˆ¶æƒã€‚è¯·å®¡æŸ¥è¿™äº›æƒé™æ˜¯å¦ç¬¦åˆä½ çš„å®‰å…¨æ¨¡å‹ã€‚

## ğŸ“‹ SFTPé…ç½®å‚æ•°å®Œæ•´è¯´æ˜

### æ ¸å¿ƒé…ç½®é¡¹è¯¦è§£

| é…ç½®é¡¹ | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|-------|------|------|--------|
| `name` | String | é…ç½®åç§°ï¼Œç”¨äºåŒºåˆ†å¤šä¸ªé…ç½® | "å¼€å‘ç¯å¢ƒ" |
| `host` | String | è¿œç¨‹æœåŠ¡å™¨åœ°å€ï¼Œå¯ä»¥æ˜¯IPæˆ–åŸŸå | "192.168.1.100" |
| `protocol` | String | ä¼ è¾“åè®®ï¼Œæ”¯æŒ"ftp"æˆ–"sftp" | "ftp" |
| `port` | Number | æœåŠ¡å™¨ç«¯å£å·ï¼ŒFTPé»˜è®¤21ï¼ŒSFTPé»˜è®¤22 | 8021 |
| `username` | String | ç™»å½•ç”¨æˆ·å | "ftpuser" |
| `password` | String | ç™»å½•å¯†ç  | "ftp123" |
| `remotePath` | String | è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ç›®æ ‡è·¯å¾„ | "/home/Code" |
| `uploadOnSave` | Boolean | ä¿å­˜æ–‡ä»¶æ—¶æ˜¯å¦è‡ªåŠ¨ä¸Šä¼  | true |
| `syncMode` | String | åŒæ­¥æ¨¡å¼ï¼Œ"full"(å®Œæ•´åŒæ­¥)æˆ–"update"(ä»…æ›´æ–°) | "update" |

### é«˜çº§é…ç½®é¡¹è¯¦è§£

| é…ç½®é¡¹ | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-------|------|------|--------|
| `passive` | Boolean | æ˜¯å¦ä½¿ç”¨è¢«åŠ¨æ¨¡å¼ï¼Œè§£å†³æŸäº›é˜²ç«å¢™ç¯å¢ƒä¸‹çš„è¿æ¥é—®é¢˜ | true |
| `debug` | Boolean | æ˜¯å¦åœ¨è¾“å‡ºçª—å£æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯ | false |
| `retryOnError` | Boolean | å‘ç”Ÿé”™è¯¯æ—¶æ˜¯å¦å°è¯•é‡æ–°è¿æ¥ | false |
| `retryCount` | Number | é‡è¯•æ¬¡æ•°ä¸Šé™ | 2 |
| `retryDelay` | Number | ä¸¤æ¬¡é‡è¯•ä¹‹é—´çš„ç­‰å¾…æ—¶é—´(æ¯«ç§’) | 10000 |
| `ignore` | Array | éœ€è¦å¿½ç•¥çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼Œæ”¯æŒglobæ¨¡å¼ | [] |
| `context` | String | ä»…åœ¨æŒ‡å®šæ–‡ä»¶å¤¹ä¸‹æ˜¾ç¤ºSFTPé€‰é¡¹ | "./" |
| `connectTimeout` | Number | è¿æ¥è¶…æ—¶æ—¶é—´(æ¯«ç§’) | 10000 |
| `privateKeyPath` | String | SSHç§é’¥è·¯å¾„ï¼Œé€‚ç”¨äºSFTPåè®® | - |
| `agent` | String | SSHä»£ç†è·¯å¾„ï¼Œé€‚ç”¨äºSFTPåè®® | - |
| `watcher` | Object | æ–‡ä»¶å˜æ›´ç›‘è§†å™¨é…ç½® | {} |

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆ

### è¿æ¥å¤±è´¥é—®é¢˜

#### 1. ç«¯å£é—®é¢˜
**ç—‡çŠ¶**: è¿æ¥è¶…æ—¶æˆ–è¿æ¥è¢«æ‹’
**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®è®¤æœåŠ¡å™¨ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ŒFTPé»˜è®¤ä¸º21ï¼ŒSFTPé»˜è®¤ä¸º22
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ç›¸åº”ç«¯å£
- ä½¿ç”¨ `netstat -anpt | grep 8021` éªŒè¯ç«¯å£æ˜¯å¦ç›‘å¬

#### 2. é˜²ç«å¢™é—®é¢˜
**ç—‡çŠ¶**: è¿æ¥å»ºç«‹åæ•°æ®ä¼ è¾“å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**: 
```json
{
    "passive": true,
    "connectTimeout": 30000
}
```

#### 3. è®¤è¯å¤±è´¥
**ç—‡çŠ¶**: 530 Login incorrect é”™è¯¯
**è§£å†³æ–¹æ¡ˆ**: 
- æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç”¨æˆ·æ˜¯å¦å­˜åœ¨: `id ftpuser`
- æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—: `tail -f var/proftpd.system.log`

#### 4. æƒé™é—®é¢˜
**ç—‡çŠ¶**: æ— æ³•ä¸Šä¼ æˆ–åˆ›å»ºæ–‡ä»¶
**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®è®¤è¿œç¨‹ç”¨æˆ·æ˜¯å¦æœ‰è¯»å†™æƒé™
- æ£€æŸ¥ç›®å½•æ‰€æœ‰æƒ: `ls -la /home/Code`
- é‡æ–°è¿è¡Œ: `bash ./init.sh`

### ä¸Šä¼ å¤±è´¥é—®é¢˜

#### 1. æ–‡ä»¶æƒé™
**è§£å†³æ–¹æ¡ˆ**: 
```bash
# æ£€æŸ¥è¿œç¨‹ç›®å½•æƒé™
ls -la /home/Code
# ä¿®å¤æƒé™
chown -R ftpuser:ftpuser /home/Code
chmod -R 755 /home/Code
```

#### 2. ç½‘ç»œé—®é¢˜
**é…ç½®ç½‘ç»œé‡è¯•å‚æ•°**: 
```json
{
    "retryOnError": true,
    "retryCount": 3,
    "retryDelay": 5000,
    "connectTimeout": 30000
}
```

#### 3. è·¯å¾„é—®é¢˜
**è§£å†³æ–¹æ¡ˆ**: 
- ç¡®è®¤ `remotePath` æ˜¯å¦æ­£ç¡®
- éªŒè¯è·¯å¾„å­˜åœ¨: `ls -la /home/Code`
- ä½¿ç”¨ç»å¯¹è·¯å¾„è€Œéç›¸å¯¹è·¯å¾„

## ğŸ¯ é«˜æ•ˆä½¿ç”¨æŠ€å·§

### å‘½ä»¤é¢æ¿æ“ä½œ

é€šè¿‡å‘½ä»¤é¢æ¿(`Ctrl+Shift+P` æˆ– `Cmd+Shift+P`)å¯ä»¥æ‰§è¡Œä»¥ä¸‹SFTPæ“ä½œï¼š

- **`SFTP: Config`** - åˆ›å»º/ç¼–è¾‘é…ç½®æ–‡ä»¶
- **`SFTP: Upload`** - ä¸Šä¼ å½“å‰æ–‡ä»¶/æ–‡ä»¶å¤¹
- **`SFTP: Download`** - ä¸‹è½½è¿œç¨‹æ–‡ä»¶/æ–‡ä»¶å¤¹
- **`SFTP: Sync Local -> Remote`** - å°†æœ¬åœ°åŒæ­¥åˆ°è¿œç¨‹
- **`SFTP: Sync Remote -> Local`** - å°†è¿œç¨‹åŒæ­¥åˆ°æœ¬åœ°
- **`SFTP: List`** - åˆ—å‡ºè¿œç¨‹ç›®å½•å†…å®¹
- **`SFTP: Cancel`** - å–æ¶ˆå½“å‰ä¼ è¾“æ“ä½œ
- **`SFTP: Set Profile`** - åˆ‡æ¢é…ç½®æ–‡ä»¶

### æ€§èƒ½ä¼˜åŒ–æŠ€å·§

#### 1. æ–‡ä»¶å¿½ç•¥ä¼˜åŒ–
```json
{
    "ignore": [
        ".git/**",
        "node_modules/**",
        "*.log",
        ".DS_Store",
        "dist/**",
        "build/**",
        "coverage/**",
        "*.tmp",
        "*.cache"
    ]
}
```

#### 2. é€‰æ‹©æ€§åŒæ­¥
```json
{
    "watcher": {
        "files": "src/**/*.{js,ts,vue,css,html}",
        "autoUpload": true,
        "autoDelete": false
    }
}
```

#### 3. å¹¶å‘ä¼ è¾“ä¼˜åŒ–
```json
{
    "concurrency": 4,
    "connectTimeout": 30000,
    "keepalive": 30000
}
```

### ç¯å¢ƒåˆ‡æ¢æœ€ä½³å®è·µ

#### å¼€å‘ç¯å¢ƒé…ç½®
```json
{
    "name": "å¼€å‘ç¯å¢ƒ",
    "uploadOnSave": true,
    "syncMode": "update",
    "debug": false,
    "retryOnError": true
}
```

#### ç”Ÿäº§ç¯å¢ƒé…ç½®
```json
{
    "name": "ç”Ÿäº§ç¯å¢ƒ",
    "uploadOnSave": false,
    "syncMode": "full",
    "debug": true,
    "retryOnError": true,
    "retryCount": 5
}
```

## ğŸ”’ å®‰å…¨é…ç½®å»ºè®®

### 1. å¯†ç å®‰å…¨
- ä¸è¦å°†åŒ…å«å¯†ç çš„é…ç½®æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- è€ƒè™‘ä½¿ç”¨SSHå¯†é’¥è®¤è¯æ›¿ä»£å¯†ç è®¤è¯
- å®šæœŸæ›´æ–°å¯†ç 

### 2. è®¿é—®æ§åˆ¶
```bash
# åœ¨ .gitignore ä¸­æ·»åŠ 
.vscode/sftp.json
.vscode/sftp-*.json
```

### 3. ç½‘ç»œå®‰å…¨
- é™åˆ¶è¿œç¨‹æ–‡ä»¶å¤¹è®¿é—®æƒé™
- ä½¿ç”¨VPNæˆ–ä¸“ç½‘è®¿é—®ç”Ÿäº§ç¯å¢ƒ
- é…ç½®é˜²ç«å¢™è§„åˆ™é™åˆ¶IPè®¿é—®

### 4. å®¡è®¡æ—¥å¿—
```bash
# å®šæœŸæ£€æŸ¥ä¼ è¾“æ—¥å¿—
tail -f var/proftpd.transfer.log

# ç›‘æ§ç³»ç»Ÿæ—¥å¿—
tail -f var/proftpd.system.log
```

## ğŸš€ é«˜çº§é…ç½®ç¤ºä¾‹

### å¤šé¡¹ç›®å·¥ä½œåŒºé…ç½®
```json
{
    "configurations": [
        {
            "name": "å‰ç«¯é¡¹ç›®",
            "context": "./frontend",
            "host": "frontend-server.com",
            "remotePath": "/var/www/frontend",
            "watcher": {
                "files": "src/**/*.{js,vue,css}"
            }
        },
        {
            "name": "åç«¯é¡¹ç›®",
            "context": "./backend", 
            "host": "backend-server.com",
            "remotePath": "/home/app/backend",
            "watcher": {
                "files": "**/*.{py,js,json}"
            }
        }
    ]
}
```

### æ¡ä»¶ä¸Šä¼ é…ç½®
```json
{
    "uploadOnSave": true,
    "downloadOnOpen": false,
    "watcher": {
        "files": "**/*",
        "autoUpload": true,
        "autoDelete": false,
        "patterns": {
            "**/*.log": false,
            "**/*.tmp": false,
            "src/**": true
        }
    }
}
```

---

ğŸ‰ **æ­å–œï¼** ä½ å·²å®Œæˆ ProFTPD æœåŠ¡å™¨é…ç½®å’Œ VS Code åŒæ­¥çš„å®Œæ•´è®¾ç½®ã€‚

æœ¬æ–‡æ¡£ä¸ºä½ çš„ ProFTPD æœåŠ¡å™¨é…ç½®å’Œ VS Code åŒæ­¥æä¾›äº†å…¨é¢çš„ä¸­æ–‡æŒ‡å—ã€‚å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–é‡æ–°æ‰§è¡Œåˆå§‹åŒ–æ­¥éª¤ã€‚ 